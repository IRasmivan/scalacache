<html><head><title>ScalaCache: Flags</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Chris Birchall" /><meta name="description" content="A facade for the most popular cache implementations, with a simple, idiomatic Scala API." /><meta name="og:image" content="/scalacache/img/poster.png" /><meta name="og:title" content="ScalaCache: Flags" /><meta name="og:site_name" content="ScalaCache" /><meta name="og:url" content="https://github.com/cb372/scalacache" /><meta name="og:type" content="website" /><meta name="og:description" content="A facade for the most popular cache implementations, with a simple, idiomatic Scala API." /><link rel="icon" type="image/png" href="/scalacache/img/favicon.png" /><meta name="twitter:title" content="ScalaCache: Flags" /><meta name="twitter:image" content="https://github.com/cb372/scalacacheimg/poster.png" /><meta name="twitter:description" content="A facade for the most popular cache implementations, with a simple, idiomatic Scala API." /><meta name="twitter:card" content="summary_large_image" /><meta name="twitter:creator" content="@cbirchall" /><link rel="icon" type="image/png" sizes="16x16" href="/scalacache/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/scalacache/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/scalacache/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/scalacache/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/scalacache/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/scalacache/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/scalacache/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/scalacache/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/scalacache/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/scalacache/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/scalacache/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/scalacache/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/scalacache/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/scalacache/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/scalacache/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/scalacache/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/scalacache/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/scalacache/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/scalacache/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/scalacache/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scalacache/highlight/styles/default.css" /><link rel="stylesheet" href="/scalacache/css/style.css" /><link rel="stylesheet" href="/scalacache/css/palette.css" /><link rel="stylesheet" href="/scalacache/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scalacache/" class="brand"><div class="brand-wrapper"><span>ScalaCache</span></div></a></li> <li><a href="/scalacache/docs/index.html" class="">Getting started</a></li> <li><a href="/scalacache/docs/modes.html" class="">Modes</a></li> <li><a href="/scalacache/docs/sync-api.html" class="">Synchronous API</a></li> <li><a href="/scalacache/docs/memoization.html" class="">Memoization</a></li> <li><a href="/scalacache/docs/flags.html" class=" active ">Flags</a></li> <li><a href="/scalacache/docs/serialization.html" class="">Serialization</a></li> <li><a href="/scalacache/docs/cache-implementations.html" class="">Cache implementations</a></li> <li><a href="/scalacache/docs/restrictions.html" class="">Troubleshooting/Restrictions</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/cb372/scalacache"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/cb372/scalacache"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('ScalaCache A facade for the most popular cache implementations, with a simple, idiomatic Scala API.');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('ScalaCache A facade for the most popular cache implementations, with a simple, idiomatic Scala API.');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="cb372" data-github-repo="scalacache"><div class="content-wrapper"><section><h3 id="flags">Flags</h3>

<p>Cache GETs and/or PUTs can be temporarily disabled using flags. This can be useful if for example you want to skip the cache and read a value from the DB under certain conditions.</p>

<p>You can set flags by defining a <a href="https://github.com/cb372/scalacache/blob/master/modules/core/shared/src/main/scala/scalacache/Flags.scala">scalacache.Flags</a> instance in implicit scope.</p>

<p>The detailed behaviour of the flags is as follows:</p>

<ul>
  <li>If <code class="highlighter-rouge">readsEnabled</code> = false, the cache will not be read, and ScalaCache will behave as if it was a cache miss. This means that memoization will compute the value (e.g. read it from a DB) and then write it to the cache.</li>
  <li>If <code class="highlighter-rouge">writesEnabled</code> = false, in the case of a cache miss, the value will be computed (e.g. read from a DB) but it will not be written to the cache.</li>
  <li>If both flags are false, memoization will not read from the cache or write to the cache.</li>
</ul>

<p>Note that your memoized method must take an implicit parameter of type <code class="highlighter-rouge">Flags</code>. Otherwise any flags you try to set using an implicit will be silently ignored.</p>

<p>Example:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">scalacache._</span>
<span class="k">import</span> <span class="nn">scalacache.memcached._</span>
<span class="k">import</span> <span class="nn">scalacache.memoization._</span>
<span class="k">import</span> <span class="nn">scalacache.modes.sync._</span>
<span class="k">import</span> <span class="nn">scalacache.serialization.binary._</span>

<span class="k">final</span> <span class="k">case</span> <span class="k">class</span> <span class="nc">Cat</span><span class="o">(</span><span class="n">id</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">colour</span><span class="k">:</span> <span class="kt">String</span><span class="o">)</span>

<span class="k">implicit</span> <span class="k">val</span> <span class="nv">catsCache</span><span class="k">:</span> <span class="kt">Cache</span><span class="o">[</span><span class="kt">Cat</span><span class="o">]</span> <span class="k">=</span> <span class="nc">MemcachedCache</span><span class="o">(</span><span class="s">"localhost:11211"</span><span class="o">)</span>

<span class="k">def</span> <span class="nf">getCatWithFlags</span><span class="o">(</span><span class="n">id</span><span class="k">:</span> <span class="kt">Int</span><span class="o">)(</span><span class="k">implicit</span> <span class="n">flags</span><span class="k">:</span> <span class="kt">Flags</span><span class="o">)</span><span class="k">:</span> <span class="kt">Cat</span> <span class="o">=</span> <span class="nf">memoizeSync</span><span class="o">(</span><span class="nc">None</span><span class="o">)</span> <span class="o">{</span>
  <span class="c1">// Do DB lookup here...
</span>  <span class="nc">Cat</span><span class="o">(</span><span class="n">id</span><span class="o">,</span> <span class="n">s</span><span class="s">"cat ${id}"</span><span class="o">,</span> <span class="s">"black"</span><span class="o">)</span>
<span class="o">}</span>

<span class="k">def</span> <span class="nf">getCatMaybeSkippingCache</span><span class="o">(</span><span class="n">id</span><span class="k">:</span> <span class="kt">Int</span><span class="o">,</span> <span class="n">skipCache</span><span class="k">:</span> <span class="kt">Boolean</span><span class="o">)</span><span class="k">:</span> <span class="kt">Cat</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">implicit</span> <span class="k">val</span> <span class="nv">flags</span> <span class="k">=</span> <span class="nc">Flags</span><span class="o">(</span><span class="n">readsEnabled</span> <span class="k">=</span> <span class="o">!</span><span class="n">skipCache</span><span class="o">)</span>
  <span class="nf">getCatWithFlags</span><span class="o">(</span><span class="n">id</span><span class="o">)</span>
<span class="o">}</span>
</code></pre></div></div>

<p>Tip: Because the flags are passed as a parameter to your method, they will be included in the generated cache key. This means the cache key will vary depending on the value of the flags, which is probably not what you want. In that case, you should exclude the <code class="highlighter-rouge">implicit flags: Flags</code> parameter from cache key generation by annotating it with <code class="highlighter-rouge">@cacheKeyExclude</code>.</p>

</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scalacache/highlight/highlight.pack.js"></script><script>hljs.configure({
languages:['scala','java','bash']
});
hljs.initHighlighting();
             </script><script>((window.gitter = {}).chat = {}).options = {
room: 'cb372/scalacache'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/scalacache/js/main.js"></script></body></html>